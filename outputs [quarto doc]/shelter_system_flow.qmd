---
title: "The Flow of Youth Experiencing Homelessness Between Shelter Systems and Permanent Housing During the Pandemic"
author: "Aliyah Maxine Ramos"
date: "`r Sys.time()`"
date-format: "D MMMM YYYY"
abstract: "This is the abstract."
format: pdf
bibliography: references.bib
execute:
  echo: false
  warning: false
  message: false
thanks: "Code and data are available at: https://github.com/mxnrms/Youth_Shelter_System_Flow.git"
---

```{r}
#| include: false

options(repos = list(CRAN="http://cran.rstudio.com/"))

# set-up packages
install.packages("opendatatoronto")
install.packages("tidyverse")
# read packages
library(tidyverse)
library(opendatatoronto)
library(dplyr)
library(janitor)
library(knitr)
library(kableExtra)
library(here)
```

```{r}
#| include: false

# download Toronto Shelter System Flow Data

library(opendatatoronto)
library(dplyr)

# get package
package <- show_package("ac77f532-f18b-427c-905c-4ae87ce69c93")
package

# get all resources for this package
resources <- list_package_resources("ac77f532-f18b-427c-905c-4ae87ce69c93")

# identify datastore resources; by default, Toronto Open Data sets datastore resource format to CSV for non-geospatial and GeoJSON for geospatial resources
datastore_resources <- filter(resources, tolower(format) %in% c('csv', 'geojson'))

# load the first datastore resource as a sample
data <- filter(datastore_resources, row_number()==1) %>% get_resource()
data
```

```{r}
# defining variables
cleaned_shelter_system_data <- read.csv(here::here("inputs/data/cleaned_shelter_system_data.csv"))

returned_from_housing_data <- read.csv(here::here("inputs/data/returned_from_housing_data.csv"))

moved_to_housing_data <- read.csv(here::here("inputs/data/moved_to_housing_data.csv"))

all_returned_from_housing_data <- read.csv(here::here("inputs/data/all_returned_from_housing_data.csv"))

all_moved_to_housing_data <- read.csv(here::here("inputs/data/all_moved_to_housing_data.csv"))
```

# 1 Introduction

Introduction here.

# 2 Data

The data is obtained from the dataset "Toronto Shelter System Flow" found in the Toronto Open Data Portal [@citedataportal]. Some finding about the dataset [@citedataset].

R [@citeR], R packages "tidyverse" [@citetidyverse], "dplyr" [@citedplyr], "janitor" [@citejanitor], "here" [@citehere], "kableExtra" [@citekableextra] and "knitr" [@citeknitr] are used to produce an extract of the cleaned dataset.

```{r}
#| fig-cap: "Total number of person(s) in various population groups experiencing homelessness that returned from permanent housing in Toronto by year (2018 to 2022)."
#| label: fig-1

#### ALL RETURNED FROM HOUSING ###
### Overall Data for Returned_From_Housing ###
all_returned_from_housing_data |>
  ggplot(mapping = aes(x = year, y = returned_from_housing, fill = group, label = returned_from_housing)) +
  geom_bar(stat = "identity") + 
  geom_text(size = 2, position = position_stack(vjust = 0.5)) +
  labs(
    title = "Population Groups that Returned from Housing \n Between 2018 and 2022",
    x = "Year",
    y = "Number of Person(s)", 
    fill = "Population Groups"
  ) + 
  theme_light()
```

Talk about it.

Also, introduce next graph.

```{r}
#| fig-cap: "Total number of person(s) in various population groups experiencing homelessness that moved to permanent housing in Toronto by year (2018 to 2022)."
#| label: fig-2

#### ALL MOVED TO HOUSING ###
### Overall Data for moved_to_housing ###
all_moved_to_housing_data |>
  ggplot(mapping = aes(x = year, y = moved_to_housing, fill = group, label = moved_to_housing)) +
  geom_bar(stat = "identity") + 
  geom_text(size = 2, position = position_stack(vjust = 0.5)) +
  labs(
    title = "Population Groups that Moved to Housing \n Between 2018 and 2022",
    x = "Year",
    y = "Number of Person(s)", 
    fill = "Population Groups"
  ) + 
  theme_light()
```

Talk about it.

Also, talk about next graph.

```{r}
#| fig-cap: "Total homeless youths that returned from permanent housing in Toronto by year (2018 to 2022)."
#| label: fig-3

#### YOUTH RETURNED FROM HOUSING ###
### LINE Graph return from housing for youth ###
ggplot(data=returned_from_housing_data, 
       aes(x = year, y = returned_from_housing, fill = year)) +
  geom_line(aes(group=1)) +
  ggtitle("Homeless Youths that Returned From Housing \n Between 2018 and 2022") +
  theme_minimal() +
  labs(
    x = "Year",
    y = "Number of Youths"
  )+
  theme(legend.position = "none")
```

Talk about it.

Also, introduce next graph.

```{r}
#| fig-cap: "Total homeless youths that moved to permanent housing in Toronto by year (2018 to 2022)."
#| label: fig-4

#### MOVED TO HOUSING ####
### LINE Graph moved to housing for youth ###
ggplot(data=moved_to_housing_data, aes(x = year, y = moved_to_housing, fill = year)) +
  geom_line(aes(group=1)) +
  ggtitle("Homeless Youths that Moved to Housing \n Between 2018 and 2022") +
  theme_minimal() +
  labs(
    x = "Year",
    y = "Number of Youths"
  )+
  theme(legend.position = "none")
```

Talk about it.

Also, introduce the table of means.

```{r}
#| tbl-cap: "Various means of homeless youths in Toronto by year (2018 to 2022)."
#| label: tbl-1

# youth mean table with returned from housing, moved to housing and actively homeless
cleaned_shelter_system_data |>
  select(
    group, 
    year, 
    newly_identified,
    actively_homeless,
    returned_from_housing, 
    moved_to_housing) |>
  filter(group == "Youth") |>
  group_by(year) |>
  summarise(
    Newly_Identified = mean(newly_identified),
    Actively_Homeless = mean(actively_homeless),
    Return_From_Housing = mean(returned_from_housing), 
    Moved_To_Housing = mean(moved_to_housing)) |>
  knitr::kable()
```

Talk about it.

# 3 Discussion

The discussion is a chance to show off what you know and what you learnt from all this.

## 3.1 First discussion point

## 3.2 Second discussion point

## 3.3 Third Discussion point

## 3.4 Weaknesses and Next Steps

Talk about weaknesses.

Talk about next steps.

\newpage

# References
